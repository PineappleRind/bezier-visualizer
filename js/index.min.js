"use strict";!function(){let $=document.querySelector.bind(document),m=(b,c,a)=>Math.round(((1-a)*b+a*c)*100)/100;var b={lines:1,midpoints:2,trail:4,controlpoints:8,finalmidpoint:16,total(){let c=0;for(let a in b)b[a]&&"number"==typeof b[a]&&(c+=b[a]);return c},compare:b=>(a.settings.show&b)===b},a={data:[[331,351],[38,351],[331,14],[38,14]],presets:[{name:"Default",data:[[30,250],[250,250],[30,30],[250,30]],show:null},{name:"Bow",data:[[143,323],[482,25],[54,21],[113,373],[231,298],[482,25],[54,21],[279,300],[371,381],[483,25],[54,20],[357,324]],show:null},{name:"Cursive f",data:[[193,313],[513,246],[42,42],[410,6],[120,586],[567,521],[53,339],[332,283]],show:null},{name:"Music note",data:[[280,240],[119,241],[340,40],[140,40],[140,500],[400,500],[40,340],[210,340]]},{name:"Warp: infinity",data:[[683,396],[592,368],[737,382],[799,228],[764,49],[639,8],[456,144],[260,331],[97,398],[9,282],[16,91],[118,0],[288,93],[486,284],[618,384],[775,330],[796,142],[719,8],[565,50],[370,230],[158,393],[48,367],[0,198],[50,31],[185,19],[373,174],[568,353],[722,391],[796,254],[774,67],[660,2],[483,119],[285,310],[115,400],[15,306],[10,114],[100,2],[263,71],[460,259],[642,393],[765,349],[799,168],[735,17],[589,34],[396,204],[205,370],[62,380],[1,225],[38,46],[163,9],,],show:b.midpoints},{name:"Warp: circle",data:[[300,600],[552,462],[573,175],[342,3],[73,104],[12,385],[216,588],[495,528],[597,256],[424,27],[137,48],[0,301],[139,553],[426,572],[597,341],[495,72],[214,13],[12,217],[75,498],[345,597],[574,422],[551,136],[297,0],[46,140],[28,427],[260,597],[529,494],[587,212],[381,11],[101,76],[4,346],[179,574],[465,550],[600,296],[459,45],[172,29],[2,262],[107,530],[389,587],[589,380],[524,100],[252,4],[25,180],[50,467],[305,600],[555,458],[571,170],[337,2],[70,108],[14,390],[221,589],[501,523],[596,251],[419,25],[132,51],[0,307],[144,556],[431,570],[598,336],[491,69],[209,14],[10,223],[78,502],[350,596],[576,418],[548,131],[292,0],[43,145],[31,432],[266,598],[532,490],[585,207],[376,10],[97,79],[4,352],[184,577],[470,547],[600,291],[454,43],[167,31],[2,267],[111,533],[394,585],[591,375],[520,96],[247,5],[23,185],[53,471],[311,600],[558,453],[568,166],[332,2],[66,112],[16,395],[226,591],[505,519],[595,246],[414,22],[128,54],[0,312]],show:b.midpoints}],settings:{speed:.003,ease:"easeInOutQuad",show:b.total(),colorAlgorithm:"goldenAngle",noCookies:void 0}};let f={" "(){u=!u,w<=.01?v.clear():w>=.999&&d(),j()},Enter(){$("#controls").classList.toggle("hidden"),$("#quickActions").classList.toggle("hidden")}};for(let n in f)document.documentElement.addEventListener("keyup",function(a){a.key===n&&f[n](a)});let o=[];var c={getData:function(){return JSON.parse(localStorage.getItem("bezierSaveData"))},set:function(){return a.noCookies?void localStorage.clear():(l(),localStorage.setItem("bezierSaveData",JSON.stringify(a)))}};c.getData()?a=c.getData():c.set();let g=b=>{$(".banner").classList.add("form-hidden"),setTimeout(function(){$(".banner").remove()},300),a.noCookies=b,c.set()};$("#bannerClose").onclick=()=>void g(!1),$("#bannerDontStore").onclick=()=>void g(!0),!1===a.noCookies&&g(!1);let p={goldenAngle:a=>`hsl(${137.50776405*a},100%,50%)`,rainbow:a=>`hsl(${20*a},100%,50%)`,grayscale:b=>`hsl(0,0%,${b/a.data.length*100}%)`};var q={easeInOutQuad:a=>a<.5?2*a*a:1-Math.pow(-2*a+2,2)/2,easeInOutExpo:a=>0===a?0:1===a?1:a<.5?Math.pow(2,20*a-10)/2:(2-Math.pow(2,-20*a+10))/2,easeInOutQuart:a=>a<.5?8*a*a*a*a:1-Math.pow(-2*a+2,4)/2,bounce:a=>a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=.545)*a+.75:a<.9?7.5625*(a-=.8182)*a+.9375:7.5625*(a-=.954)*a+.984375,linear:a=>a},r=[];function s(b,c){let a=document.createElement("DIV");a.classList.add("toast"),a.classList.add(c),a.innerHTML=b,setTimeout(function(){a.classList.add("showing"),setTimeout(function(){a.classList.remove("showing"),setTimeout(function(){a.remove()},500)},3e3)}),document.body.appendChild(a)}a.data.forEach(function(_c,b){r.push(p[a.settings.colorAlgorithm](b))});let t=a.data.length-1,u=!0;var h={element:$("#canvas"),context:$("#canvas").getContext("2d"),clear:function(){h.context.clearRect(0,0,h.element.width,h.element.height)}},v={element:$("#canvas2"),context:$("#canvas2").getContext("2d"),clear:function(){v.context.clearRect(0,0,v.element.width,v.element.height)}},w=0,x=1;function y(b,d){x++,r.push(p[a.settings.colorAlgorithm](x)),a.data.push([b,d]),t=a.data.length-1,G(),c.set()}function i(){h.element.setAttribute("height",window.innerHeight),h.element.setAttribute("width",window.innerWidth),v.element.setAttribute("height",window.innerHeight),v.element.setAttribute("width",window.innerWidth)}i(),onresize=()=>{i(),G()};let z={point(b,c,d,a){h.context.beginPath(),h.context.arc(b,c,d,0,2*Math.PI,!0),h.context.closePath(),a?h.context.fillStyle=a:h.context.fillStyle="#ffffff",h.context.fill()},line(a,b,c,d){h.context.beginPath(),h.context.strokeStyle="#ffffff",h.context.moveTo(a,b),h.context.lineTo(c,d),h.context.stroke()},trail(c,d,e,f){if(!b.compare(b.trail))return;(e||f)&&!(w<.03)||(e=c,f=d);let{context:a}=v,i=(a,b)=>Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2)),g=i({x:e,y:f},{x:c,y:d});if(g>2*Math.PI)for(let h=0;h<g;h++)a.beginPath(),a.fillStyle="#ffffff",a.arc(m(e,c,h/g),m(f,d,h/g),10,0,2*Math.PI,!0),a.fill();a.beginPath(),a.fillStyle="#ffffff",a.arc(c,d,10,0,2*Math.PI,!0),a.fill()}};function j(){!0===u?(window.requestAnimationFrame(B),$("#quickPlay").classList.add("playing")):(window.cancelAnimationFrame(B),$("#quickPlay").classList.remove("playing")),$("#playBtn").innerHTML=$("#quickPlay").innerHTML=u?"Stop":"Play"}function d(){u?window.cancelAnimationFrame(B):window.requestAnimationFrame(B),w=0,h.clear(),v.clear(),u=!0,G()}$("#minimize").onclick=_a=>{$("#quickActions").classList.toggle("hidden"),$("#speedometer").classList.toggle("hidden"),$("#controls").classList.toggle("hidden")},$("#playBtn").onclick=$("#quickPlay").onclick=_a=>{u=!u,w<=.01&&v.clear(),j()},$("#replayBtn").onclick=d,$("#quickReplay").onclick=d,$("#resetCurveBtn").onclick=function(){a.data=[[331,351],[38,351],[331,14],[38,14]],c.set()},$("#animationSpeed").oninput=b=>{$("#animationSpeedLabel").innerHTML=b.target.value,a.settings.speed=+b.target.value},$("#tValue").oninput=a=>{$("#tValueLabel").innerHTML=a.target.value,w=+a.target.value,B(),u=!1,j()},j(),I();let A=[];function B(){h.clear(),a.settings.ease||(a.settings.ease="quadraticEaseInOut");let c=q[a.settings.ease](w);$("#speedometer").innerHTML=$("#tValue").value=$("#tValueLabel").innerHTML=c.toFixed(3),w+=a.settings.speed,function(e){t=a.data.length-1,o=Array.from({length:t},()=>[]);for(let b=0;b<t;b++)for(let c=0;c<t-b;c++){let d=0===b?a.data:o[b-1];o[b].push([m(d[c][0],d[c+1][0],e),m(d[c][1],d[c+1][1],e)])}}(c);let b=H();z.trail(b[0],b[1],A[0],A[1]),A=b,G(),window.cancelAnimationFrame(B),w>=1|| !1===u?(u=!1,j()):window.requestAnimationFrame(B)}var C=!1,D=-1;function k(f){if(!0===C){var d=f.clientX,e=f.clientY;if(-1!=D){g(D);return}for(var b=0;b<a.data.length;b++)if(!0===F(d,e,b)){if(-1===D&&(D=b),d<0||e<0||d>window.innerWidth||e>window.innerHeight)break;g(b);break}}function g(b){a.data[b][0]=d,a.data[b][1]=e,h.clear(),G(),c.set()}}function E(a,c){var b=a.indexOf(c);return b> -1&&a.splice(b,1),a}function F(d,e,b){let{data:c}=a;return(d>=c[b][0]&&d<=c[b][0]+10||d<=c[b][0]&&d>=c[b][0]-10)&&(e>=c[b][1]&&e<=c[b][1]+10||e<=c[b][1]&&e>=c[b][1]-10)||D===b}function G(){let{data:d}=a;for(var c=0;c<d.length;c++)b.compare(b.lines)&&c<d.length-1&&z.line(d[c][0],d[c][1],d[c+1][0],d[c+1][1]),b.compare(b.controlpoints)&&z.point(d[c][0],d[c][1],10,r[c])}function H(){for(let a=0;a<o.length;a++)for(let c=0;c<o[a].length;c++){let d=3;if(a===o.length-1&&b.compare(b.finalmidpoint)&&(d=10),(b.compare(b.midpoints)||10===d&&b.compare(b.finalmidpoint))&&z.point(o[a][c][0],o[a][c][1],d),b.compare(b.lines)&&c>0&&z.line(o[a][c][0],o[a][c][1],o[a][c-1][0],o[a][c-1][1]),a===o.length-1)return[o[a][c][0],o[a][c][1]]}}function I(){let d=document.querySelectorAll(".showCheckbox");for(let a=0;a<d.length;a++){let c=d[a];c.checked=!1,b.compare(b[c.getAttribute("id")])&&(c.checked=!0)}}function l(){$("#saveDataTextarea").value=JSON.stringify(a)}onmousedown=function(){C=!0},onmouseup=function(){C=!1,D=-1},onmousemove=k,window.ontouchmove&&window.ontouchstart&&(ontouchstart=function(){C=!0},ontouchmove=function(a){k(a.touches[0])}),h.element.ondblclick=function(g){for(var d=g.clientX,e=g.clientY,f=0,b=0;b<a.data.length;b++){if(!0===F(d,e,b)&&a.data.length<=2){s("You can't have less than 2 points","info");break}if(!0===F(d,e,b)&&a.data.length>2)D=b,a.data=E(a.data,a.data[b]),h.clear(),c.set(),t=a.data.length-1,G(),D=-1;else{if(f++,b===a.data.length-1&&f===a.data.length-1)break;if(b===a.data.length-1&&f===a.data.length){y(d,e);break}}}},$("#easeOption").oninput=function(){a.settings.ease=$("#easeOption").value,c.set()},oninput=e=>{let d=e.target;if("TEXTAREA"===d.tagName)return;"colorOption"===d.id&&(a.settings.colorAlgorithm=e.target.value,r=[],a.data.forEach(function(_c,b){r.push(p[a.settings.colorAlgorithm](b))}),c.set());let f=d.getAttribute("id");b[f]&&(a.settings.show^=b[f],c.set())},$("#animationSpeed").value=a.settings.speed,$("#colorOption").parentElement.innerHTML=function(){let c='<select id="colorOption">';for(let b in p)selected="",a.settings.colorAlgorithm===b&&(selected="selected"),c+=`<option value="${b}" name="${b}" ${selected}>${b}</option>`;return c+"</select>"}(),$("#loadSaveDataBtn").onclick=_b=>void function(){let e=$("#saveDataTextarea");try{var b=JSON.parse(e.value)}catch(f){s(`Invalid data structure<br><small style="font-weight:200"> ${f}</small>`,"error");return}if(!b.data)return s("Invalid save code: no data","error");for(let d=0;d<b.data.length;d++)if(2!=b.data[d].length)return s(`Invalid save code <br><small style="font-weight:200">Data point ${d+1} has invalid coordinates</small>`,"error");a=b,c.set(),s("Successfully loaded save code","success")}(),l(),$("#quickPlay").onclick=()=>{w>=.999?(d(),window.cancelAnimationFrame(B)):(u=!u,j())};var e=$("#presetSelectChoice");e.innerHTML=function(){let b="";for(let[d,c]of a.presets.entries())b+=`<option value="${d}"${c.data===a.data?" selected":""}>${c.name}</option>`;return b}(),e.oninput=()=>{var f;let b;f=+e.value,b=a.presets[f],a.data=b.data,a.settings.show=b.show||31,d(),c.set(),I(),c.set()}}()